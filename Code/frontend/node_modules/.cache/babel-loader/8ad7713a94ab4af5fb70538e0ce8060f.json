{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\achini\\\\Documents\\\\GitHub\\\\matara-matara-mtr_2022_wd_2\\\\Code\\\\frontend\\\\src\\\\components\\\\MainPage.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Post from \"./Post\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Mainpage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      posts: null,\n      post: \"\",\n      isloggedin: true\n    };\n    this.getPosts();\n    axios.get(\"https://localhost:8070/api/isloggedin\").then(res => {\n      if (!res.data) {\n        return this.setState({\n          isloggedin: false\n        });\n      }\n    });\n    this.changeHandler = this.changeHandler.bind(this);\n    this.submitHandler = this.submitHandler.bind(this);\n    this.getPosts = this.getPosts.bind(this);\n  }\n\n  getPosts() {\n    axios.get(\"https://localhost:8070/api/showposts\").then(posts => this.setState({\n      posts: posts.data\n    }));\n  }\n\n  submitHandler(e) {\n    e.preventDefault();\n    axios.post(\"https://localhost:8070/api/addpost\", {\n      post: this.state.post\n    }).then(res => {\n      this.setState({\n        post: \"\"\n      });\n      this.getPosts();\n    });\n  }\n\n  changeHandler(e) {\n    this.setState({\n      post: e.target.value\n    });\n  }\n\n  render() {\n    return this.state.isloggedin ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => axios.get(\"https://localhost:8070/api/logout\").then(res => window.location = \"/\"),\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.submitHandler,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: this.state.post,\n          placeholder: \"post\",\n          onChange: this.changeHandler,\n          type: \"text\",\n          name: \"post\",\n          id: \"post\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), this.state.posts && this.state.posts.map(post => {\n        return /*#__PURE__*/_jsxDEV(Post, {\n          getposts: this.getPosts,\n          info: post\n        }, post._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 20\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this) : /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Please login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Mainpage;","map":{"version":3,"names":["React","Component","axios","Post","Mainpage","constructor","props","state","posts","post","isloggedin","getPosts","get","then","res","data","setState","changeHandler","bind","submitHandler","e","preventDefault","target","value","render","window","location","map","_id"],"sources":["C:/Users/achini/Documents/GitHub/matara-matara-mtr_2022_wd_2/Code/frontend/src/components/MainPage.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport Post from \"./Post\";\r\nclass Mainpage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      posts: null,\r\n      post: \"\",\r\n      isloggedin: true\r\n    };\r\n    this.getPosts();\r\n    axios\r\n      .get(\"https://localhost:8070/api/isloggedin\")\r\n      .then(res => {\r\n        if (!res.data) {\r\n          return this.setState({ isloggedin: false });\r\n        }\r\n      });\r\n    this.changeHandler = this.changeHandler.bind(this);\r\n    this.submitHandler = this.submitHandler.bind(this);\r\n    this.getPosts = this.getPosts.bind(this);\r\n  }\r\n  getPosts() {\r\n    axios\r\n      .get(\"https://localhost:8070/api/showposts\")\r\n      .then(posts => this.setState({ posts: posts.data }));\r\n  }\r\n  submitHandler(e) {\r\n    e.preventDefault();\r\n    axios\r\n      .post(\"https://localhost:8070/api/addpost\", {\r\n        post: this.state.post\r\n      })\r\n      .then(res => {\r\n        this.setState({ post: \"\" });\r\n        this.getPosts();\r\n      });\r\n  }\r\n  changeHandler(e) {\r\n    this.setState({ post: e.target.value });\r\n  }\r\n  render() {\r\n    return this.state.isloggedin ? (\r\n      <div>\r\n        <button\r\n          onClick={() =>\r\n            axios\r\n              .get(\"https://localhost:8070/api/logout\")\r\n              .then(res => (window.location = \"/\"))\r\n          }\r\n        >\r\n          Logout\r\n        </button>\r\n        <form onSubmit={this.submitHandler}>\r\n          <input\r\n            value={this.state.post}\r\n            placeholder=\"post\"\r\n            onChange={this.changeHandler}\r\n            type=\"text\"\r\n            name=\"post\"\r\n            id=\"post\"\r\n          />\r\n          <button type=\"submit\">submit</button>\r\n        </form>\r\n        {this.state.posts &&\r\n          this.state.posts.map(post => {\r\n            return <Post getposts={this.getPosts} key={post._id} info={post} />;\r\n          })}\r\n      </div>\r\n    ) : (\r\n      <h3>Please login</h3>\r\n    );\r\n  }\r\n}\r\nexport default Mainpage;"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,QAAjB;;;AACA,MAAMC,QAAN,SAAuBH,SAAvB,CAAiC;EAC/BI,WAAW,CAACC,KAAD,EAAQ;IACjB,MAAMA,KAAN;IACA,KAAKC,KAAL,GAAa;MACXC,KAAK,EAAE,IADI;MAEXC,IAAI,EAAE,EAFK;MAGXC,UAAU,EAAE;IAHD,CAAb;IAKA,KAAKC,QAAL;IACAT,KAAK,CACFU,GADH,CACO,uCADP,EAEGC,IAFH,CAEQC,GAAG,IAAI;MACX,IAAI,CAACA,GAAG,CAACC,IAAT,EAAe;QACb,OAAO,KAAKC,QAAL,CAAc;UAAEN,UAAU,EAAE;QAAd,CAAd,CAAP;MACD;IACF,CANH;IAOA,KAAKO,aAAL,GAAqB,KAAKA,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAArB;IACA,KAAKC,aAAL,GAAqB,KAAKA,aAAL,CAAmBD,IAAnB,CAAwB,IAAxB,CAArB;IACA,KAAKP,QAAL,GAAgB,KAAKA,QAAL,CAAcO,IAAd,CAAmB,IAAnB,CAAhB;EACD;;EACDP,QAAQ,GAAG;IACTT,KAAK,CACFU,GADH,CACO,sCADP,EAEGC,IAFH,CAEQL,KAAK,IAAI,KAAKQ,QAAL,CAAc;MAAER,KAAK,EAAEA,KAAK,CAACO;IAAf,CAAd,CAFjB;EAGD;;EACDI,aAAa,CAACC,CAAD,EAAI;IACfA,CAAC,CAACC,cAAF;IACAnB,KAAK,CACFO,IADH,CACQ,oCADR,EAC8C;MAC1CA,IAAI,EAAE,KAAKF,KAAL,CAAWE;IADyB,CAD9C,EAIGI,IAJH,CAIQC,GAAG,IAAI;MACX,KAAKE,QAAL,CAAc;QAAEP,IAAI,EAAE;MAAR,CAAd;MACA,KAAKE,QAAL;IACD,CAPH;EAQD;;EACDM,aAAa,CAACG,CAAD,EAAI;IACf,KAAKJ,QAAL,CAAc;MAAEP,IAAI,EAAEW,CAAC,CAACE,MAAF,CAASC;IAAjB,CAAd;EACD;;EACDC,MAAM,GAAG;IACP,OAAO,KAAKjB,KAAL,CAAWG,UAAX,gBACL;MAAA,wBACE;QACE,OAAO,EAAE,MACPR,KAAK,CACFU,GADH,CACO,mCADP,EAEGC,IAFH,CAEQC,GAAG,IAAKW,MAAM,CAACC,QAAP,GAAkB,GAFlC,CAFJ;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,eAUE;QAAM,QAAQ,EAAE,KAAKP,aAArB;QAAA,wBACE;UACE,KAAK,EAAE,KAAKZ,KAAL,CAAWE,IADpB;UAEE,WAAW,EAAC,MAFd;UAGE,QAAQ,EAAE,KAAKQ,aAHjB;UAIE,IAAI,EAAC,MAJP;UAKE,IAAI,EAAC,MALP;UAME,EAAE,EAAC;QANL;UAAA;UAAA;UAAA;QAAA,QADF,eASE;UAAQ,IAAI,EAAC,QAAb;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QATF;MAAA;QAAA;QAAA;QAAA;MAAA,QAVF,EAqBG,KAAKV,KAAL,CAAWC,KAAX,IACC,KAAKD,KAAL,CAAWC,KAAX,CAAiBmB,GAAjB,CAAqBlB,IAAI,IAAI;QAC3B,oBAAO,QAAC,IAAD;UAAM,QAAQ,EAAE,KAAKE,QAArB;UAA8C,IAAI,EAAEF;QAApD,GAAoCA,IAAI,CAACmB,GAAzC;UAAA;UAAA;UAAA;QAAA,QAAP;MACD,CAFD,CAtBJ;IAAA;MAAA;MAAA;MAAA;IAAA,QADK,gBA4BL;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QA5BF;EA8BD;;AAtE8B;;AAwEjC,eAAexB,QAAf"},"metadata":{},"sourceType":"module"}